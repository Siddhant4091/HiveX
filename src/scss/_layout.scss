.layout {
  display: grid;
  grid-template-columns: 284px 1fr minmax(280px, 378px) 45px; // Added 45px for right margin
  grid-template-rows: 81px 1fr;
  grid-template-areas: 
    "drawer navbar navbar ."
    "drawer main-content chat .";
  height: 100vh;
  overflow: hidden;
  background-color: #F6F6F6;
  transition: grid-template-columns 0.3s ease-in-out;
  width: 100vw; // Ensure layout doesn't exceed viewport width
  max-width: 100vw; // Prevent horizontal overflow
  box-sizing: border-box; // Include padding/borders in width calculation

  .sidebar {
    grid-area: drawer;
  }

  .top-navbar {
    grid-area: navbar;
  }

  .content-area {
    grid-area: main-content;
    overflow-y: auto;
    padding: 0 40px;
    overflow-x: hidden;
    max-width: 100%;
    min-width: 0;
    box-sizing: border-box; // Include padding in width calculation
    width: 100%; // Ensure it doesn't exceed container width

    scrollbar-width: none; 
    -ms-overflow-style: none;

    &::-webkit-scrollbar {
      display: none;
    }
  }

  .chat-window {
    grid-area: chat;
    width: 100%;
    max-width: 378px;
    min-width: 280px;
    height: calc(100% - 16px); 
    border-radius: 12px;
    border: 1px solid #D6D6D6;
    margin: 0 45px 16px 0;
    max-height: calc(100vh - 96px);
    overflow: hidden;
    box-sizing: border-box;
  }

  // Collapsed sidebar layout
  &.sidebar-collapsed {
    grid-template-columns: 80px 1fr minmax(280px, 378px) 45px; /* Collapsed drawer, main section, chat section, right margin */
    
    &.settings-layout {
      grid-template-columns: 80px 1fr 45px; /* Collapsed drawer, main section, right margin */
    }

    &.chat-closed {
      grid-template-columns: 80px 1fr 45px; /* Collapsed drawer, main section, right margin */
    }
  }

  // Chat closed layout
  &.chat-closed {
    grid-template-columns: 284px 1fr 45px; /* Drawer, main section, right margin */
    grid-template-areas: 
      "drawer navbar ."
      "drawer main-content .";
  }

  // Settings layout - hide chat and expand content
  &.settings-layout {
    grid-template-columns: 280px 1fr 45px; /* Drawer, main section, right margin */
    grid-template-areas: 
      "drawer navbar ."
      "drawer main-content .";

    .content-area.settings-content {
      grid-column: 2;
      width: 100%;
      max-width: none;
    }
  }

  // Responsive breakpoints
  @media (max-width: 1400px) {
    grid-template-columns: 284px 1fr minmax(280px, 350px) 45px;
    
    &.sidebar-collapsed {
      grid-template-columns: 80px 1fr minmax(280px, 350px) 45px;
    }
  }

  @media (max-width: 1200px) {
    grid-template-columns: 284px 1fr 300px 45px;
    
    &.sidebar-collapsed {
      grid-template-columns: 80px 1fr 300px 45px;
    }
    
    .chat-window {
      min-width: 260px;
      max-width: 300px;
    }
  }

  @media (max-width: 1024px) {
    // On smaller screens, hide chat by default or make it overlay
    grid-template-columns: 284px 1fr 45px;
    grid-template-areas: 
      "drawer navbar ."
      "drawer main-content .";
    
    &.sidebar-collapsed {
      grid-template-columns: 80px 1fr 45px;
    }
    
    .chat-window {
      display: none; // Hide chat on smaller screens
    }
  }

  @media (max-width: 768px) {
    // Mobile layout - stack everything
    grid-template-columns: 1fr;
    grid-template-areas: 
      "navbar"
      "main-content";
    
    .sidebar {
      display: none; // Hide sidebar on mobile, could be made into a drawer
    }
    
    .content-area {
      padding: 0 16px;
    }
  }
}
